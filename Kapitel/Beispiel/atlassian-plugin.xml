<?xml version="1.0" encoding="UTF-8"?>

<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}"/>
        <param name="plugin-icon">images/pluginIcon.png</param>
        <param name="plugin-logo">images/pluginLogo.png</param>
    </plugin-info>

    <!-- add our i18n resource -->
    <resource type="i18n" name="i18n" location="timelogplugin"/>

    <!-- add our web resources -->
    <web-resource key="timelogplugin-resources" name="timelogplugin Web Resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>

        <resource type="download" name="timelogplugin.css" location="/css/timelogplugin.css"/>
        <resource type="download" name="timelogplugin.js" location="/js/timelogplugin.js"/>
        <resource type="download" name="images/" location="/images"/>

        <context>timelogplugin</context>
    </web-resource>

    <component-import key="applicationProperties" interface="com.atlassian.sal.api.ApplicationProperties"/>

    <ao key="ao-module">
        <description>The module configuring the Active Objects service used by this plugin</description>
        <entity>de.lineas.jira.timelogplugin.projectmapping.datastorage.TimeToJiraProject</entity>
        <entity>de.lineas.jira.timelogplugin.integraltimeuser.datastorage.IntegralTimeToken</entity>
    </ao>

    <component-import key="ao" name="Active Objects service" interface="com.atlassian.activeobjects.external.ActiveObjects">
        <description>Component to access Active Objects functionality from the plugin</description>
    </component-import>

    <component key="time-to-jira-project-service" name="integral.time to Jira mapping service"
               class="de.lineas.jira.timelogplugin.projectmapping.datastorage.TimeToJiraProjectServiceImpl"/>

    <component key="integral-time-project-service" name="integral.time Project service"
               class="de.lineas.jira.timelogplugin.projectmapping.integraltime.ProjectServiceMock"/>

    <component key="integral-time-task-service" name="integral.time Task service"
               class="de.lineas.jira.timelogplugin.taskmapping.integraltime.TaskServiceMock"/>

    <component key="integral-time-user-service" name="integral.time User serivce"
               class="de.lineas.jira.timelogplugin.integraltimeuser.integraltime.UserServiceMock"/>

    <component key="integral-time-token-service" name="integral.time Token service for ActiveObjects"
               class="de.lineas.jira.timelogplugin.integraltimeuser.datastorage.IntegralTimeTokenServiceImpl"/>

    <component key="integral-time-tracking-service" name="integral.time Arbeitszeitprotokoll Service"
               class="de.lineas.jira.timelogplugin.timetracking.integraltime.MockTimeTrackingService"/>

    <web-section key="integral-time-section" location="atl.jira.proj.config" i18n-name-key="de.lines.jira.itimesync.section.title" weight="900">
        <label key="de.lines.jira.itimesync.section.title"/>
        <tooltip>integral.time Synchronisation</tooltip>
    </web-section>

    <web-item key="de.lines.jira.itimesync.projectmapping" name="project_mapping" section="atl.jira.proj.config/integral-time-section"
              i18n-name-key="de.lines.jira.itimesync.projectmapping" weight="20">
        <label key="de.lines.jira.itimesync.projectmapping"/>
        <link linkId="de.lineas.jira.itimesyncplugin.projectMapping">/secure/timeToJira!default.jspa?projectId=${project.getId()}</link>
    </web-item>

    <web-item key="de.lineas.jira.timelogplugin.integraltimeuser" section="system.user.options/personal" weight="200" name="integral.time-login">
        <label key="de.lineas.jira.timelogplugin.integraltimeuser"/>
        <link linkId="de.lineas.jira.timelogplugin.integraltimeuser">/secure/authTimeUser!default.jspa</link>
        <conditions type="and">
            <condition class="de.lineas.jira.timelogplugin.integraltimeuser.TimeTokenNotExisting"/>
        </conditions>
        <styleClass>trigger-dialog</styleClass>
    </web-item>

    <web-item key="de.lineas.jira.timelogplugin.integraltimeuser-logout" section="system.user.options/personal" weight="200" name="integral.time-logout">
        <label key="de.lineas.jira.timelogplugin.integraltimeuser-logout"/>
        <link linkId="de.lineas.jira.timelogplugin.integraltimeuser">/secure/logoutTimeUser!default.jspa</link>
        <conditions type="and">
            <condition class="de.lineas.jira.timelogplugin.integraltimeuser.TimeTokenExisting"/>
        </conditions>
        <styleClass>trigger-dialog</styleClass>
    </web-item>

    <web-item key="de.lineas.jira.timelogplugin.timetracking" section="operations-top-level" weight="200" name="logtime">
        <label key="de.lineas.jira.timelogplugin.timetracking-logtime.name"/>
        <link linkId="de.lineas.jira.timelogplugin.timetracking">/secure/timeTracking!default.jspa?issueKey=${issue.getKey()}</link>
        <conditions type="and">
            <condition class="de.lineas.jira.timelogplugin.projectmapping.IntegralTimeProjectMapped"/>
            <condition class="de.lineas.jira.timelogplugin.taskmapping.IntegralTimeTaskMapped"/>
        </conditions>
        <styleClass>trigger-dialog</styleClass>
    </web-item>

    <webwork1 key="timeTrackingWebwork" name="Zeitverfolgung" class="java.lang.Object">
        <actions>
            <action name="de.lineas.jira.timelogplugin.timetracking.TimeTrackingAction" alias="timeTracking">
                <view name="input">/templates/de/lineas/timelogplugin/timetracking/input.vm</view>
                <view name="success">/templates/de/lineas/timelogplugin/timetracking/success.vm</view>
            </action>
        </actions>
    </webwork1>

    <webwork1 key="timeToJiraProjectMappingWebwork" name="integral.time Projekt Zuordnung" class="java.lang.Object">
        <actions>
            <action name="de.lineas.jira.timelogplugin.projectmapping.TimeToJiraProjectAction" alias="timeToJira">
                <view name="input">/templates/de/lineas/timelogplugin/projectmapping/input.vm</view>
                <view name="success">/templates/de/lineas/timelogplugin/projectmapping/success.vm</view>
            </action>
            <action name="de.lineas.jira.timelogplugin.projectmapping.integraltime.MockProjectController" alias="projectController">
                <view name="list">/templates/de/lineas/timelogplugin/projectmapping/list.vm</view>
                <command name="delete" alias="projectController">
                    <view name="list">/templates/de/lineas/timelogplugin/projectmapping/list.vm</view>
                </command>
                <command name="add" alias="projectController">
                    <view name="list">/templates/de/lineas/timelogplugin/projectmapping/list.vm</view>
                </command>
            </action>
        </actions>
    </webwork1>

    <webwork1 key="mockIntegralTimeTaskController" name="Mock-integral.time Task Controller" class="java.lang.Object">
        <actions>
            <action name="de.lineas.jira.timelogplugin.taskmapping.integraltime.TaskStore" alias="taskController">
                <view name="list">/templates/de/lineas/timelogplugin/taskmapping/list.vm</view>
                <command name="delete" alias="taskController">
                    <view name="list">/templates/de/lineas/timelogplugin/taskmapping/list.vm</view>
                </command>
                <command name="add" alias="taskController">
                    <view name="list">/templates/de/lineas/timelogplugin/taskmapping/list.vm</view>
                </command>
            </action>
        </actions>
    </webwork1>

    <customfield-type i18n-name-key="time-task-mapping-cf.name" key="time-task-selection-cf"
                      class="de.lineas.jira.timelogplugin.taskmapping.TimeTaskSelectionCF">
        <description key="time-task-mapping-cf.description"/>
        <resource type="velocity" name="view" location="templates/de/lineas/timelogplugin/taskmapping/timeTaskSelectView.vm"/>
        <resource type="velocity" name="edit" location="templates/de/lineas/timelogplugin/taskmapping/timeTaskSelectEdit.vm"/>
    </customfield-type>

    <customfield-type i18n-name-key="planned-hours-cf.name" key="planned-hours-cf"
                      class="de.lineas.jira.timelogplugin.taskmapping.PlannedHoursCF">
        <description key="planned-hours-cf.description"/>
        <resource type="velocity" name="view" location="templates/de/lineas/timelogplugin/taskmapping/plannedHoursView.vm"/>
        <resource type="velocity" name="edit" location="templates/de/lineas/timelogplugin/taskmapping/plannedHoursEdit.vm"/>
    </customfield-type>

    <webwork1 key="integralTimeUserWebwork" i18n-name-key="authenticate-time-user.name" class="java.lang.Object">
        <actions>
            <action name="de.lineas.jira.timelogplugin.integraltimeuser.AuthenticateTimeUserAction" alias="authTimeUser">
                <view name="input">/templates/de/lineas/timelogplugin/integraltimeuser/authuser-input.vm</view>
                <view name="success">/templates/de/lineas/timelogplugin/integraltimeuser/authuser-success.vm</view>
            </action>
            <action name="de.lineas.jira.timelogplugin.integraltimeuser.LogoutTimeUserAction" alias="logoutTimeUser">
                <view name="logout">/templates/de/lineas/timelogplugin/integraltimeuser/authuser-logout.vm</view>
            </action>
            <action name="de.lineas.jira.timelogplugin.integraltimeuser.integraltime.MockUserController" alias="userController">
                <view name="list">/templates/de/lineas/timelogplugin/integraltimeuser/list.vm</view>
                <command name="delete" alias="userController">
                    <view name="list">/templates/de/lineas/timelogplugin/integraltimeuser/list.vm</view>
                </command>
            </action>
        </actions>
    </webwork1>

    <web-panel key="integral-time-web-panel" location="atl.jira.view.issue.right.context" weight="5">
        <context-provider class="de.lineas.jira.timelogplugin.timetracking.TimetrackingOverviewDataProvider"/>
        <label key="de.lineas.jira.timelogplugin.webpanelintegraltime"/>
        <resource name="view" type="velocity" location="templates/de/lineas/timelogplugin/timetracking/view.vm"/>
    </web-panel>

    <issue-tabpanel key="integral-time-worklog" class="de.lineas.jira.timelogplugin.timetracking.Worklog">
        <description>Stellt das Arbeitsprotokoll dar.</description>
        <label key="de.lineas.jira.timelogplugin.worklog"/>
    </issue-tabpanel>
</atlassian-plugin>
